---
type: post
category: plan
---
# 31st week: Goodbye WHV NZ

This week is my last chance to get a NZ WHV visa of my life. I didn't get it, sad.

I wrote a [page](https://codesandbox.io/p/github/gongbaodd/react-babylonjs-svg-mesh/main?layout=%257B%2522sidebarPanel%2522%253A%2522EXPLORER%2522%252C%2522rootPanelGroup%2522%253A%257B%2522direction%2522%253A%2522horizontal%2522%252C%2522contentType%2522%253A%2522UNKNOWN%2522%252C%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522id%2522%253A%2522ROOT_LAYOUT%2522%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522contentType%2522%253A%2522UNKNOWN%2522%252C%2522direction%2522%253A%2522vertical%2522%252C%2522id%2522%253A%2522clkxtvnml000h3e6xpknv88gp%2522%252C%2522sizes%2522%253A%255B70%252C30%255D%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522contentType%2522%253A%2522EDITOR%2522%252C%2522direction%2522%253A%2522horizontal%2522%252C%2522id%2522%253A%2522EDITOR%2522%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL%2522%252C%2522contentType%2522%253A%2522EDITOR%2522%252C%2522id%2522%253A%2522clkxtvnmk000c3e6xuug5xz14%2522%257D%255D%252C%2522sizes%2522%253A%255B100%255D%257D%252C%257B%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522contentType%2522%253A%2522SHELLS%2522%252C%2522direction%2522%253A%2522horizontal%2522%252C%2522id%2522%253A%2522SHELLS%2522%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL%2522%252C%2522contentType%2522%253A%2522SHELLS%2522%252C%2522id%2522%253A%2522clkxtvnmk000g3e6xy3qev2y4%2522%257D%255D%252C%2522sizes%2522%253A%255B100%255D%257D%255D%257D%252C%257B%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522contentType%2522%253A%2522DEVTOOLS%2522%252C%2522direction%2522%253A%2522vertical%2522%252C%2522id%2522%253A%2522DEVTOOLS%2522%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL%2522%252C%2522contentType%2522%253A%2522DEVTOOLS%2522%252C%2522id%2522%253A%2522clkxtvnmk000e3e6xyi12qp3g%2522%257D%255D%252C%2522sizes%2522%253A%255B100%255D%257D%255D%252C%2522sizes%2522%253A%255B50%252C50%255D%257D%252C%2522tabbedPanels%2522%253A%257B%2522clkxtvnmk000c3e6xuug5xz14%2522%253A%257B%2522id%2522%253A%2522clkxtvnmk000c3e6xuug5xz14%2522%252C%2522activeTabId%2522%253A%2522clkxtycgk01au3e6xpnmhmt17%2522%252C%2522tabs%2522%253A%255B%257B%2522type%2522%253A%2522FILE%2522%252C%2522filepath%2522%253A%2522%252Fsrc%252FComponents%252FCrash.tsx%2522%252C%2522id%2522%253A%2522clkxtycgk01au3e6xpnmhmt17%2522%252C%2522mode%2522%253A%2522temporary%2522%257D%255D%257D%252C%2522clkxtvnmk000e3e6xyi12qp3g%2522%253A%257B%2522id%2522%253A%2522clkxtvnmk000e3e6xyi12qp3g%2522%252C%2522activeTabId%2522%253A%2522clkxtwh2h00y43e6xkxghz19s%2522%252C%2522tabs%2522%253A%255B%257B%2522type%2522%253A%2522TASK_PORT%2522%252C%2522taskId%2522%253A%2522dev%2522%252C%2522port%2522%253A5173%252C%2522id%2522%253A%2522clkxtwh2h00y43e6xkxghz19s%2522%252C%2522mode%2522%253A%2522permanent%2522%252C%2522path%2522%253A%2522%252F%2522%257D%255D%257D%252C%2522clkxtvnmk000g3e6xy3qev2y4%2522%253A%257B%2522id%2522%253A%2522clkxtvnmk000g3e6xy3qev2y4%2522%252C%2522activeTabId%2522%253A%2522clkxtwdyl00ma3e6xcircdgox%2522%252C%2522tabs%2522%253A%255B%257B%2522id%2522%253A%2522clkxtvnmk000f3e6xvjfw6yvv%2522%252C%2522mode%2522%253A%2522permanent%2522%252C%2522type%2522%253A%2522TERMINAL%2522%252C%2522shellId%2522%253A%2522clkxtvnv5000nhgi2h6knbve8%2522%257D%252C%257B%2522type%2522%253A%2522TASK_LOG%2522%252C%2522taskId%2522%253A%2522dev%2522%252C%2522id%2522%253A%2522clkxtwdyl00ma3e6xcircdgox%2522%252C%2522mode%2522%253A%2522permanent%2522%257D%255D%257D%257D%252C%2522showDevtools%2522%253Atrue%252C%2522showShells%2522%253Atrue%252C%2522showSidebar%2522%253Atrue%252C%2522sidebarPanelSize%2522%253A15%257D) as a meme about Twitter changing its logo into X. Which was as a tutorial to learn shader in babylonjs.

raczzalan.webgl-glsl-editor is an extension for vscode to write glsl without a language server.

Using a shader material is simple, just pass ther vertex and fragments as a parameter.

```jsx
        <sphere name="fireworks" ref={setSphere}>
            <shaderMaterial name="fireworks-mat"
                ref={setMat}
                shaderPath={{vertexSource, fragmentSource}}
                options={{
                    attributes: ["position", "normal", "uv"],
                    uniforms: ["worldViewProjection", "time"],
                    needAlphaBlending: true,
                }}
                backFaceCulling={false}
            />
        </sphere>
```

the attributes and uniforms are the variables that can be used in the shader. There are some varaibles that are automatically passed to the shader, like `worldViewProjection` and `time`. They are documented in [threejs](https://threejs.org/docs/#api/en/materials/ShaderMaterial) and [babylonjs](https://doc.babylonjs.com/features/featuresDeepDive/materials/shaders/introToShaders).

attribute is the data passed before compile and uniforms can be changed during rendering.

There are two functions to send attributes. `mesh.setVerticesBuffer` and `mesh.registerInstancedBuffer`. The first one is for the data that is the same for every vertex, this is a simple [example](https://www.babylonjs-playground.com/#QCLQFN#39), like the position of the vertex. The second one is for the data that is different for every instance, This is the [example](https://playground.babylonjs.com/#8L50Q3#203).


```js
const centroidBuffer = new Buffer(engine, centroid, false, 3)
const centroidVBuffer = centroidBuffer.createVertexBuffer("center", 0, 3)
mesh.setVerticesBuffer(centroidVBuffer)

mesh.registerInstancedBuffer("direction", 3)
mesh.instancedBuffers.direction = directionBuffer
```

sending uniforms is simple. Like `material.setFloat("time", time)`. Sadly the animation in babylon has not support shader material.

Next week, I will try to learn how to use the node editor with [this video](https://www.youtube.com/watch?v=K0PXzE1hJXg&ab_channel=Babylonjs).