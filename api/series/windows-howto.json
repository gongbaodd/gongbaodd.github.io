{"posts":[{"id":"2019/11/28/windows powertoy.md","slug":"2019/11/28/windows-powertoy","body":"\n# 安利一下 Windows Powertoy\n\n这是最近 Windows 开源的一个应用，可以拓展 Windows 的一些功能，比如下图的 Fancy zones，可以提高 Windows 的分屏功能。\n\n![fancy zones](https://ws1.sinaimg.cn/mw690/89d0a2e1gy1g9drryez7hj22gu1bo4dr.jpg)\n\n可惜目前只支持 x64 平台，但是 github 上面已经有[issue](https://github.com/microsoft/PowerToys/issues/413)跟踪了。\n\n目前还不能在 Windows 商店里面安装，可以利用 chocolatey 安装。\n\n```batch\nsudo choco install powertoys\n```\n","collection":"blog","data":{"type":"post","category":"tech","tag":["windows"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2019/12/23/UWP.md","slug":"2019/12/23/uwp","body":"\n# 为 UWP 应用打开代理\n\n最近我在做去手机依赖的事情，没错，我是一个特别喜欢听播客的人。由于最近一年我用的都是 Google podcast，我不得不一直依赖于我的手机，可是我发现这是一件及其容易分心的事儿（听播客其实也是分心的事儿）。无论如何，我先花了大概一个小时的时间把我新订阅的 podcast 转移到 pocketcast 里面，并导出到 Windows 里面。\n\n导入的时候发现，其实 UWP 应用是运行在沙盒下面的，每个应用都互相隔离，不受全局的代理配置影响，这可难了我了。\n\n首先能找到的是微软技术支持提供的[利用 netsh 利用组策略代理](https://support.microsoft.com/zh-cn/help/4494447/use-group-policy-to-apply-winhttp-proxy-settings-to-clients)，实际体验发现没啥屌用。\n\n```\nnetsh winhttp set proxy localhost:1080\n```\n\n然后按照[ss 的 issue 来做](https://github.com/shadowsocks/shadowsocks-windows/issues/897#ref-issue-312924039)，貌似有一些请求通过代理了，但是大部分还是不行。\n\n```\nforeach($f in Get-ChildItem $env:LOCALAPPDATA\\Packages) {CheckNetIsolation.exe LoopbackExempt -a \"-n=$($f.Name)\"}\n```\n","collection":"blog","data":{"type":"post","category":"life","series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2020/01/28/spotify.md","slug":"2020/01/28/spotify","body":"\n# 白嫖 spotify 的方式\n\n今年开始，我不再在家办公，这使得我的网络环境不是很稳定，无法一直在线听 spotify。最好的办法，自然是把要听的音乐缓存下来。\n\nGitHub 里面有一个 python 项目[spotify-downloader](https://github.com/ritiek/spotify-downloader)可以下载 spotify 的音频。\n\n利用 pip 安装\n\n```shell\npip install spotdl\n```\n\n因为是国内使用，需要代理\n\n```shell\nenv https_proxy=http://127.0.0.1:1080 spotdl --song http://open.spotify.com/xxx\n```\n\n另外，spotdl 支持列表下载\n\n```shell\nspotdl --playlist [listUrl] # to get all songs' url\nspotdl --list list.txt # to download the songs\n```\n","collection":"blog","data":{"type":"post","category":"tech","tag":["spotify"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2020/01/31/monect.md","slug":"2020/01/31/monect","body":"\n# Monect 让手机变成鼠标\n\n自从我的 XPS 键盘坏了，我就打算使用 K380 键盘替代我的笔记本键盘，然而这样使用触摸板就很困难。\n\n很久之前我就想让手机成为我的远程键盘，以前用 Linux 的时候有一个 KDE connect 可以实验通过 wifi 链接。但是因为我住的公寓 wifi 貌似会阻拦互相发现，最好的办法还是用蓝牙链接。去年稍稍了解了一些 blueman 的相关知识，其实蛮有意思的，可惜拖延症没有继续下去（确实比较有意思，苹果曾开发过一个协议，通过商场蓝牙派发广告）。\n\n回到正题，可以通过 Monenct 官网下载 PC 的 host，在 play store 下载 client，monect 支持 wifi、蓝牙以及 usb 链接。这样即使有一种连接方式暂时不可用其他方式能够立马替换。\n","collection":"blog","data":{"type":"post","category":"tech","series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2020/02/04/Powershell-Windows.md","slug":"2020/02/04/powershell-windows","body":"\n# 用 Powershell 更新 Windows\n\n发现已经半个月没有被 Windows 更新打扰了，原来是一个累积更新挂了，我发现在图形界面下面怎么更新都失败，于是寻思在命令行执行。\n\n在 powershell 中有一个包 PSUpdateWindows 可以派上用场。\n\n```powershell\nInstall-Module PSUpdateWindow\n\nGet-WindowsUpdate #下载更新\n\nInstall-WindowsUpdate #安装更新\n```\n","collection":"blog","data":{"type":"post","category":"tech","tag":["powershell"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2020/02/22/Windows-strokesPlus.md","slug":"2020/02/22/windows-strokesplus","body":"\n# 分享一个 Windows 下面的鼠标手势工具 StrokesPlus\n\n我终于还是妥协了，在使用 windows 的情况下最好还是配备一个鼠标。尤其是当你在编程的时候。并不是说触摸屏不好，在很多时候，触摸屏可以在可以帮你记录一些东西。比如让你写一些算法的时候，你可以在旁边画一画。\n\n但是不得不说，编辑器就像 VS code。他对触摸屏的交互其实是很反人类的。另外由于我现在是三台设备。所以我的键盘是同时连着三台设备。。这说明当我要操作我的笔记本的时候，身体要跨过两个键盘的距离。这个动作幅度是比较大的。\n\n所以我在网上买了这个科大讯飞的鼠标，他有一个最大的好处就是，我可以说话打字。这样我就不需要操作键盘了。但是 windows 上面还有另外一个问题，就是鼠标，还有触摸屏和触摸板，三者都没有统一的交互体验。所以我又安装了这个鼠标手势工具。\n\nStrokesPlus 安装很简单，依然使用的是 chocolatey。\n\n```shell\nsudo choco install strokesplus\n```\n\n其实我的需求很简单，就是需要鼠标手势来操作切换桌面。安装好 strokePlus，打开 action 菜单即可添加手势。\n\n- @：代表\"Win\"键\n- +：代表“Shift”键\n- ^：代表“Ctrl”键\n- %：代表“Alt”键\n\n如进入右边桌面的命令为`acSendKeys(\"^@{RIGHT}\")`。\n\n添加\n\n- `acSendKeys(\"^@{RIGHT}\")` 进入右桌面\n- `acSendKeys(\"^@{LEFT}\")` 进入左桌面\n- `acSendKeys(\"@{TAB}\")` 全部桌面\n\n配合 GestureSign，终于触摸屏，触摸板和鼠标手势统一了。\n","collection":"blog","data":{"type":"post","category":"tech","tag":["windows"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2020/02/23/Mouse-without-borders.md","slug":"2020/02/23/mouse-without-borders","body":"\n# Mouse without borders 让鼠标同时连接 4 台 PC\n\n既然已经给我的 PC 买上了鼠标，那我肯定希望，三台 PC 能够共用这一个鼠标。在网上查询了一下，发现需要这个需求的人不止我一个。所以微软有一个项目叫做[mouse without border](https://www.microsoft.com/en-us/download/details.aspx?id=35460)。\n\n只要三台设备在同一个域下，我就可以通过这一个软件，让三台设备共享鼠标。\n\n今天忙活了半天这个软件，主要是自如的 wifi 5GHz 设置了防火墙，但是 2.4GHz 没有...所以只要有一台设备连接的是 2.4G 赫兹的网络。就可以进入内网，跟其他的设备交互共享鼠标了。\n","collection":"blog","data":{"type":"post","category":"tech","tag":["windows"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2020/03/11/WSL2-Virtualbox.md","slug":"2020/03/11/wsl2-virtualbox","body":"\n# 应该是目前最好的 WSL2 和 Virtualbox 共存的方法了\n\n因为 WSL2 使用的是 Hyper-V（看来微软爸爸并不是完全拥抱开源了），所以其它虚拟化软件都不能和它共存，所以目前最好的办法就是在开机的时候做一个切换。\n\n```batch\nbcdedit /copy {current} /d \"Disable Hyper-V\"\n```\n\n上面操作会生成一个 GUID，它对应开机目录上一个选项，接下来把他的 hyper-v 选项关掉\n\n```batch\nbcdedit /set {<GUID>} hypervisorlaunchtype off\n```\n\n如果本地已经关闭了 hyper-v，可以执行下面的命令打开。\n\n```batch\nbcdedit /set {<GUID>} hypervisorlaunchtype auto\n```\n\n重启的时候长按 shift 键就可以唤起启动目录了。\n","collection":"blog","data":{"type":"post","category":"tech","tag":["WSL2","virtualbox","hyper-v"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2020/04/28/keyLemon.md","slug":"2020/04/28/keylemon","body":"\n# keyLemon 让任何一个摄像头都支持人脸登入\n\nWindows hello 是一个用一次就回不去的功能，目前我的笔记本支持指纹登入，一台平板外接了一个指纹接收器，另一台只能 PIN 码登入。显然 PIN 码用起来就不是很爽，然而这机器还是用来看书的。\n\n然而 Windows Hello 对摄像头要求很苛刻，于是我在想，有没有类似于安卓的单镜头解锁方案，KeyLemon 就是，v3 版本已经支持 Windows 10，虽然网上有评论说这软件免费版只能用 7 天，但是软件中只看到三种授权方式，basic 仅支持一张人脸和无活体检测的人脸登录，貌似这个 basic 就是免费版。\n\n实际体验，这个软件受光照影响很大，晚上录入的脸到早上就不识别了，这时输入 PIN 码依然可以登入。\n","collection":"blog","data":{"type":"post","category":"tech","tag":["windows","facial-recognition","keyLemon"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2020/05/06/spacedesk.md","slug":"2020/05/06/spacedesk","body":"\n# spacedesk 让任意一台设备成为扩展屏幕\n\n之前我有一篇[文章](/tech/2020/02/23/Mouse_without_borders让鼠标同时连接四台设备.html)，让鼠标和键盘能跨越四台 Windows，而[spacedesk](https://spacedesk.net/)则是让所有设备成为主计算机的扩展屏幕，注意，这里是所有，包括 Windows 设备和手机设备，应该是类似于 miracast 的技术，安利应用商店里的 slave 端，运行很快。\n","collection":"blog","data":{"type":"post","category":"tech","tag":["windows"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2020/05/11/WSL-Xserver.md","slug":"2020/05/11/wsl-xserver","body":"\n# WSL 下运行 Xserver 鼠标太小\n\n不太清楚是不是 HIDPI 造成的，在 VcXsrv 下面的鼠标指针及其小。解决方法只能是换一个看起来大一些的鼠标。\n\n```shell\nsudo apt-get install big-cursor\n```\n\n接下来，重命名 VcXsrv 下面的`font/misc`（比如`C:\\Program Files\\VcXsrv\\fonts\\misc)`）的`cursor.pcf.gz`为`cursor-small.pcf.gz`。\n\n然后将刚才安装在 wsl 中的`/usr/share/fonts/X11/misc/big-cursor.pcf.gz`拷贝到上面的目录下，并重命名为`cursor.pcf.gz`。\n\n重启 VcXsrv 即可。\n","collection":"blog","data":{"type":"post","category":"tech","tag":["windows","wsl","vcxsrv"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2021/01/09/PowerShell101.md","slug":"2021/01/09/powershell101","body":"\n# Powershell 101\n\n已经打算学习 Powershell 很久了，然而工作时间使用的是 Mac，所以往往觉得 bash 已经足够了，即使 Windows 下面 WSL 和 MSYS 总能解决。但是经历了这次 ReactNative 编译失败的经验之后，我马上意识到什么叫做原生的好（尤其是在网络环境极其严苛的情况之下）。\n\n学习 Powershell 的资源相比 bash 还是比较少的，基本上也是靠社团驱动。社团驱动虽然活跃性高，出现的问题还是比较明显的，比如 bash 就有两种写法...那么 Powershell 除了本身的.Net 支持同时支持 shell 语法就更加艰难了。\n\n「Powershell 101」是微软官网推荐的书籍，其实是一次分享的幻灯片 PDF，我在网上还没有找到分享视频，不过光看文档还能了解一二。\n\n## Cmdlet\n\nCmdlet 是 Powershell 下的命令，通过「动词-名词」组成如`Get-Process`和`Get-Help`，可以通过使用`Get-Verb`获取到动词都有哪些。\n\n## 变量\n\n和 PHP 类似，powershell 变量使用\\$做标识。\n\n```powershell\n$i = 42; $i # 控制台输出42\n```\n\n同时，和 bash 不同的是，Powershell 中的命令返回的是对象。\n\n```powershell\n$count = (ls ./).count # 控制台输出当前目录文件个数\n```\n\n## profile\n\n和 bash 的 profile 类似，powershell 也有类似于`bashrc`的东西。每个系统有 4 个 profile 文件。\n\n- 每个用户的单一 powershell 端\n- 所有用户的单一 powershell 端\n- 每个用户的所有 powershell 端\n- 所有用户的所有 powershell 端\n\n## 工具\n\n安装`posh-git`来自动提示`git`和`oh-my-posh`来美化界面。\n\n```powershell\nInstall-Module posh-git -Scope CurrentUser\nInstall-Module oh-my-posh -Scope CurrentUser\n```\n\n修改`$profile`并且引入这两个包，并设定 oh-my-posh 的主题。\n\n```powershell\nImport-Module oh-my-posh\nImport-Module posh-git\nSet-Theme Robbyrussell\n```\n\n另外，系统可能禁止执行外部代码，造成上面的脚本无法执行，此时需要在管理员模式下面修改规则。\n\n```powershell\nget-executionpolicy # 可能输出 Restrictrd\nset-executionpolicy remotesigned\n```\n","collection":"blog","data":{"type":"post","category":"tech","tag":["powershell"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2021/01/10/AudoRelay.md","slug":"2021/01/10/audorelay","body":"\n# AudioRelay蓝牙耳机实现多设备切换的优雅方法\n\n其实在蓝牙4.0之后，蓝牙耳机已经能够实现在多个设备上面无缝切换了。但是还是有很多耳机并不支持多设备，比如我手上的红米Dots。但不妨换个方法，让多个设备的音频流输出到同意设备中，这样只需要耳机链接一台设备即可。\n\nAudioRelay就是类似这样的软件，只需让设备都在同一局域网中。然而这个软件并不完美，首先，它只是复制了音频流到手机上，计算机必须静音，否则就在外放。兼容性上面也有问题，经测试我的小米平板静音之后音频流也静音了。最后是安全性，这个软件没有密钥配置，也就是同一局域网下所有的设备都是透明的，所以最好不要在公有网络中使用这款软件。","collection":"blog","data":{"type":"post","category":"tech","tag":["bluetooth"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2021/01/13/Barrier.md","slug":"2021/01/13/barrier","body":"\n# Barrier更好的多屏交互方式\n\n之前介绍过[Mouse Without Borders](https://blog.gongbushang.com/tech/2020/02/23/Mouse_without_borders%E8%AE%A9%E9%BC%A0%E6%A0%87%E5%90%8C%E6%97%B6%E8%BF%9E%E6%8E%A5%E5%9B%9B%E5%8F%B0%E8%AE%BE%E5%A4%87.html)，可以实现多台PC共享鼠标和键盘，在过去的一年里它帮了我不少忙，也有如下bug。\n\n- 长时间使用，鼠标滚轮会时常失效。\n- 和Stroke Plus使用的时候，不小心跨屏会导致stroke plus崩溃。\n- 鼠标在不同PPi的屏幕里面速度是不一样的。\n- 因为项目已经停止更新了，所以以上问题只能默默忍受。\n\n因此我更换了barrier，作为收费项目synergy的免费分支，拥有和synergy类似的兼容Mac、PC以及Linux上限达15台的多屏协同，本来是有安卓的，可惜已经停止支持了。\n\n目前看来上面的问题都已经解决了，但还要看长期使用的效果。","collection":"blog","data":{"type":"post","category":"tech","tag":["windows"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2021/03/11/Windows.md","slug":"2021/03/11/windows","body":"\n# 让 Windows 更加频繁的同步系统时间\n\n最近发现我的平板时钟不对，第一反应是主板电池没电了，可是拆开也没找到电池在哪，算了，干脆价格定时任务更新时间。\n\nWindows 下面有一个 task scheduler 可以新建定时任务，在 microsoft>Windows>Time Synchronization,需要新建两个任务`%windir%\\system32\\sc.exe start w32time task_started`和`%windir%\\system32\\w32tm.exe /resync`[参考文章](https://www.pretentiousname.com/timesync/)\n","collection":"blog","data":{"type":"post","category":"tech","tag":["windows"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2022/03/21/Barrier-DeskDroid-Universal Control.md","slug":"2022/03/21/barrier-deskdroid-universal-control","body":"\n# Barrier 和 DeskDroid 实现苹果的 Universal Control\n\n今天被人显摆了苹果的 Universal Control 了，作为跨屏协同用了这么久的我，为啥不显摆一下我现有的桌面配置呢？\n\nDeskDroid 的最新版本是可以和 Barrier 集成的，需要在设置中选择集成到 barrier，会有提示提醒如何把现有机器配置到 barrier 的设置里。\n\n由于 DeskDroid 基于 adb，可以很简单实现 adb 的无线连接\n\n```shell\nadb devices # 展示现在有线连接的设备\nadb tcpip 5555 # 打开设备无线的5555端口，成功后可以断开有线了（如果有多台设备连接，需要用-s指定设备）\nadb connect ${DeviceIP}:5555\n```\n\n现在就可以实现全局操控了。\n","collection":"blog","data":{"type":"post","category":"tech","tag":["windows"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}},{"id":"2022/05/30/WSL2.md","slug":"2022/05/30/wsl2","body":"\n# WSL2加载虚拟硬盘\n\n在最新版的Windows11中，WSL2新增了[mount参数](https://docs.microsoft.com/zh-cn/windows/wsl/wsl2-mount-disk\n)可以加载虚拟硬盘了。\n\n依过去的经验WSL经常会更新崩溃，所以开发的时候我会把代码仓库和系统放在两个分区里，然而在Linux中操作NTFS是非常慢的，最好是新建一个Ext4的虚拟硬盘，再挂载到Linux中。\n\n在Windows的磁盘管理可以新建`.vhdx`文件（默认新建好会自动挂载，以后双击文件也可加载硬盘），然后使用Diskgen将这个磁盘分区并格式化成Ext4格式。\n\n接着在Powershell执行`GET-CimInstance -query \"SELECT * from Win32_DiskDrive\"`查看挂载的硬盘DiskPath，紧接着管理员执行`sudo wsl --mount <DiskPath> --bare`将硬盘挂载到WSL中。\n\n进入Linux里面，执行`lsblk`查看新加载的分区如sda3，新建文件夹`work`，并把这个分区挂在上去`sudo mount /dev/sda3 work`，完成。\n\nExt4的磁盘格式比NTFS快得不是一星半点，只可惜这些都只能在Windows11中实现，而且目前还没有更好的自动化实现方案。","collection":"blog","data":{"type":"post","category":"tech","tag":["windows"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}}]}