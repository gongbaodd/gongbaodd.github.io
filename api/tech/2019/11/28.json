{"posts":[{"id":"2019/11/28/Ubuntu-sslocal.md","slug":"2019/11/28/ubuntu-sslocal","body":"\n# 树莓派 Ubuntu 实现 sslocal 负载匀衡\n\n由于某些原因，我配置了多个 ssserver，windows 客户端可以简单配置负载匀衡，而在 linux 上面需要借助 haproxy。\n\n首先，因为我的服务是 aes-255-gcm 加密方式，需要升级 ss 客户端。\n\n```shell\npip install https://github.com/shadowsocks/shadowsocks/archive/master.zip -U\n```\n\n修改 sslocal 配置，server 连接的是本地 haproxy 端口，增加/etc/shadowsocks/default.json\n\n```JSON\n{\n    \"server\": \"127.0.0.1\",\n    \"server_port\": 8888,\n    \"local_address\": \"127.0.0.1\",\n    \"local_port\": 1234,\n    \"password\": \"password\",\n    \"timeout\": 50,\n    \"method\": \"aes-256-gcm\",\n    \"fast_open\": true,\n    \"workers\": 2\n}\n```\n\n为 sslocal 增加 service，增加/etc/systemd/system/sslocal.service\n\n```ini\n[Unit]\nDescription=Shadowsocks\nAfter=network.target\n\n[Service]\nExecStart=/usr/local/bin/sslocal -c /etc/shadowsocks/default.json\nRestart=on-abort\n\n[Install]\nWantedBy=multi-user.target\n```\n\n好了，sslocal 的部分说完了，接下来 apt 安装 haproxy，修改/etc/haproxy/haproxy.cfg，增加以下行。\n\n```INI\nlisten status\n    bind *:1111\n    mode  http\n    stats refresh 30s\n    stats uri /status\n    stats realm Haproxy\n    stats auth admin:admin\n\nfrontend ss-in\n    mode tcp\n    bind *:8888\n    default_backend ss-out\n\nbackend ss-out\n    mode tcp\n    option tcp-check\n    balance roundrobin\n    server xxx <server>:<port> check\n    server yyy <server>:<port> check\n    server zzz <server>:<port> check\n```\n\n配置完成还要改一下 systemd，/etc/systemd/system/haproxy.service，修改 After 和 Wants 字段，用 network-online.target 替换 network.target。\n\n最后用 systemd 启动 haproxy 和 sslocal。\n\n```shell\nsudo systemd enable haproxy\nsudo systemd enable sslocal\n```\n\n**_参考链接_**\n\n[求教如何让 ss 客户端支持 aes-256-gcm 加密方式](https://www.ubuntukylin.com/ukylin/forum.php?mod=viewthread&tid=188059)\n\n[guyskk/shadowsocks-server.service](https://gist.github.com/guyskk/a9665bc6b2a89b73fae34678b1f6dc6b)\n\n[多 Shadowsocks 服务器负载均衡](https://www.solarck.com/haproxy-shadowsocks-balance.html)\n\n[解决 Haproxy 用 Systemd 启动失败的问题](https://www.solarck.com/systemd-wait-network-online.html)\n","collection":"blog","data":{"type":"post","category":"tech"}},{"id":"2019/11/28/windows powertoy.md","slug":"2019/11/28/windows-powertoy","body":"\n# 安利一下 Windows Powertoy\n\n这是最近 Windows 开源的一个应用，可以拓展 Windows 的一些功能，比如下图的 Fancy zones，可以提高 Windows 的分屏功能。\n\n![fancy zones](https://ws1.sinaimg.cn/mw690/89d0a2e1gy1g9drryez7hj22gu1bo4dr.jpg)\n\n可惜目前只支持 x64 平台，但是 github 上面已经有[issue](https://github.com/microsoft/PowerToys/issues/413)跟踪了。\n\n目前还不能在 Windows 商店里面安装，可以利用 chocolatey 安装。\n\n```batch\nsudo choco install powertoys\n```\n","collection":"blog","data":{"type":"post","category":"tech","tag":["windows"],"series":{"slug":"windows-howto","name":"Windows舒适指南"}}}]}