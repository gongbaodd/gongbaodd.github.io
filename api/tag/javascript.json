{"posts":[{"id":"2020/02/22/hoisting.md","slug":"2020/02/22/hoisting","body":"\n# æˆ‘ä¹Ÿè°ˆè°ˆ hoisting\n\næœ€è¿‘åœ¨çœ‹ getify çš„[You-Dont-Know-JS](https://github.com/getify/You-Dont-Know-JS)ï¼Œç¬¬äºŒç‰ˆé‡Œé¢ç›¸å¯¹äºç¬¬ä¸€ç‰ˆå¢åŠ äº†å¾ˆå¤šä¸ªäººè®¤ä¸ºæ¯”è¾ƒç¡¬æ ¸çš„ä¸œè¥¿ã€‚ç¬¬äºŒç‰ˆè²Œä¼¼å¯¹ var å…³é”®å­—è¿›è¡Œäº†æ´—ç™½ï¼Œå°±ç›®å‰æ¥çœ‹è¿˜æ˜¯æ¯”è¾ƒäº‰è®®çš„ï¼Œæ¯•ç«Ÿè¿™å‡ å¹´æ¥æˆ‘åŸºæœ¬ä¸Šå·²ç»ç”¨ let å®Œå…¨æ›¿ä»£ var äº†ã€‚\n\næœ€è¿‘æˆ‘æ­£å¥½æ˜¯åœ¨å­¦ä¹  Rustï¼Œé¦–å…ˆè¯´æ˜ä¸€ä¸‹ Rust çš„ç¡®æ˜¯ä¸€ä¸ªä¸å¤ªå¥½å­¦ä¹ çš„è¯­è¨€ï¼Œä½†æ˜¯å­¦ä¼šäº†ä¹‹åå°±ä¼šå¯¹ç¼–è¯‘åŸç†æœ‰æ›´é«˜æ›´æ·±ä¸€å±‚æ¬¡çš„è®¤è¯†ï¼ˆåŒæ ·å­¦ä¼šäº† typescriptï¼Œä¹Ÿä¼šæœ‰ç±»ä¼¼çš„æ„Ÿè§‰ï¼‰ã€‚\n\né‚£ä¹Ÿè®¸æ˜¯æ—¶ä»£çš„é—®é¢˜ã€‚äººä»¬å‘ç°é¢å‘å¯¹è±¡å¹¶ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œé¢å‘å‡½æ•°é€æ¸çš„ä»åŸæ¥ä¸å—äººæ³¨æ„ï¼Œå˜çš„å—äººç†è§£ã€‚å°¤å…¶æ˜¯æœ€è¿‘æˆ‘è¿˜è·Ÿä¸€äº›äººåœ¨è®¨è®ºåˆ°ä¸€äº›é¢å‘å¯¹è±¡çš„ç»§æ‰¿å±æ€§ã€‚ä»¥åçš„ä»¥åçš„ç»§æ‰¿ï¼Œå°†é€æ¸è¢«ç»„åˆæ‰€æ›¿ä»£ã€‚ç”šè‡³æ˜¯ rustï¼Œé‡Œé¢å·²ç»æ²¡æœ‰äº†ç»§æ‰¿å…³ç³»ã€‚è€Œæœ€å—æ¬¢è¿çš„å‰ç«¯æ¡†æ¶ react æ¡†æ¶ä¹Ÿé€æ¸çš„ä½¿ç”¨å‡½æ•°æ¥æ›¿ä»£å¯¹è±¡ã€‚\n\né‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å›é¡¾ä¸€ä¸‹ï¼Œ2015 å¹´ï¼Œé‚£å¹´ TC39 å‘å¸ƒäº† ECMA2015ï¼ŒåŒ…æ‹¬å—çº§ä½œç”¨åŸŸï¼Œletï¼Œclass ç­‰å…³é”®å­—ã€‚å½“æ—¶ JavaScript çš„ä½œè€…ï¼ŒBrendan Eich å°±è¯´ä»–ä¸èµæˆè¿™ä¸ªå¯¹è±¡çš„è®¾è®¡ï¼Œä½†æ˜¯æ˜¾ç„¶å¾ˆå¤šäººæ²¡æœ‰ç†è§£ï¼Œå½“ç„¶åæ¥è¿˜å‘ç”Ÿäº†å…³äº class æˆå‘˜æ˜¯å¦è·Ÿåˆ†å·çš„ bugã€‚\n\né‚£ä¹ˆç°åœ¨æˆ‘ä»¬æŠŠå½“å¹´çš„äº‹æƒ…å†æ‹¿å‡ºæ¥çœ‹ä¸€çœ‹ã€‚Hoisting è¿™ä¸ª JavaScript ç‹¬æœ‰çš„ç‰¹æ€§ï¼Œæ˜¯ä¸æ˜¯ä¸€ä¸ªé¸¡è‚‹çš„ bugã€‚\n\nå‚è€ƒ BrendanEich è€çˆ·å­è‡ªå·±çš„[è¯](https://twitter.com/brendaneich/status/562313394431078400)\n\n> function declaration hoisting is for mutual recursion & generally to avoid painful bottom-up ML-like order\n\n> `var` hoisting was an implementation artifact. `function` hoisting was better motivated.\n\né¦–å…ˆæ˜¯ ML è¿™ä¸ªè¯­è¨€å‘¢ä¹Ÿæ˜¯ä¸€ä¸ªåŸºäºå‡½æ•°çš„è¯­è¨€ã€‚ä½†æ˜¯è·Ÿ js ä¸å¤ªä¸€æ ·çš„æ˜¯ï¼Œè¿™ä¸ªè¯­è¨€å°±æ²¡æœ‰ hoistingï¼Œæ‰€ä»¥å‘¢ï¼Œçœ‹ä»£ç å°±åªèƒ½æ˜¯ä¸€è¡Œä¸€è¡Œçš„çœ‹ä¸‹å»ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚\n\nè‡³äº var çš„æå‡ï¼Œåˆ™æ˜¯å®ç° function å¸¦æ¥çš„äººå·¥äº§ç‰©ã€‚\n\næƒ³ä¸€æƒ³ 2015 å¹´ä¹‹å‰æˆ‘ä»¬å†™å‰ç«¯ js ä»£ç çš„æ—¶å€™ï¼Œå¾€å¾€ä¼šæŠŠä¾èµ–çš„ function æ”¾åˆ°æœ€åº•ä¸‹ã€‚\n\n```javascript\nfunction foo() {\n  bar1();\n  bar2();\n  bar3();\n\n  return;\n\n  function bar1() {}\n\n  function bar2() {}\n\n  function bar3() {}\n}\n```\n\nå…¶å®å°±åƒä½ ç°åœ¨è¿™ä¸ªè§’åº¦æ¥è§‚å¯Ÿè¿™ä¸ªä»£ç ï¼Œä¹Ÿä¼šè§‰å¾—ã€‚è¿™ä¸ªè¯­è¨€çš„ç¡®æœ‰å®ƒçš„ç‹¬åˆ°ä¹‹å¤„ã€‚è¿™æ ·çš„å†™æ³•ï¼Œç›´æ¥é€šè¿‡ return å…³é”®å­—ï¼ŒæŠŠä¸€ä¸ªå‡½æ•°åˆ†æˆäº†æ„é€ å‡½æ•°éƒ¨åˆ†å’Œä»–çš„ç§æœ‰æˆå‘˜ã€‚å¦‚æœæƒ³è¦äº†è§£è¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½çš„è¯ï¼Œå¤§å¯ä¸å¿…æŠŠæ‰€æœ‰çš„å‡½æ•°éƒ½çœ‹ä¸€éã€‚\n\nè‡ªä»æœ‰äº†å—çº§ä½œç”¨åŸŸï¼ŒJavaScript å°±å¿…é¡»è¦è€ƒè™‘ï¼ŒåŒæ—¶å­˜åœ¨å—çº§ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸçš„æƒ…å†µï¼Œå°±å‡ºç°äº† TDZ çš„æƒ…å†µã€‚ç®€å•è®²å°±æ˜¯è¯´ï¼Œå°±æ˜¯å—çº§ä½œç”¨åŸŸï¼Œå˜é‡ä¸èƒ½è¢«é‡å¤å£°æ˜ï¼Œå³ä½¿æ˜¯ä½¿ç”¨å‡½æ•°å£°æ˜ï¼Œè€Œä»¥å‰çš„ var å…³é”®å­—æ˜¯å¯ä»¥é‡æ–°å®šä¹‰çš„ï¼ˆå½“ç„¶é‡æ–°å®šä¹‰çš„æ—¶å€™æ²¡æœ‰é‡æ–°èµ‹å€¼ï¼Œå› ä¸ºæå‡çš„å…³ç³»é‡æ–°å®šä¹‰ï¼Œå¹¶ä¸å­˜åœ¨ï¼‰ã€‚\n\n```javascript\n{\n  let foo = \"foo\";\n  var foo; // wrong\n}\n```\n\n```javascript\n{\n  var foo = \"foo\";\n  let foo; // wrong\n}\n```\n\né‚£ä¹ˆå—çº§ä½œç”¨åŸŸæœ‰æ²¡æœ‰æå‡å‘¢ï¼Ÿé‚£è‚¯å®šæ˜¯æœ‰çš„ï¼Œå› ä¸ºå¦‚æœä½ æƒ³åˆ¤æ–­è¿™ä¸ªä½œç”¨åŸŸä¸‹é¢çš„å˜é‡æ˜¯ä¸æ˜¯è¢«é‡æ–°å®šä¹‰äº†ï¼Œè¿˜æ˜¯è¦é¢„å…ˆç”³è¯·å†…å­˜çš„ã€‚åªä¸è¿‡åœ¨ä»–å£°æ˜ä¹‹å‰è¢«ä½¿ç”¨çš„è¯ï¼Œç›¸æ¯”äºå‡½æ•°å˜é‡è¿”å›æœªå®šä¹‰çš„å€¼ï¼Œå—çº§ä½œç”¨åŸŸä¼šæŠ¥é”™ã€‚\n\næ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬ä¼šæŠŠå—çº§ä½œç”¨åŸŸå˜é‡å®šä¹‰æ”¾åœ¨è¿™ä¸ªå—å„¿çš„æœ€ä¸Šé¢ï¼Œæ¥æ¶ˆé™¤ TDZã€‚\n\nä½†æ˜¯æŠŠå®šä¹‰æ”¾åœ¨æœ€ä¸Šé¢çš„è¯ï¼Œå°±å¦‚ä¹‹å‰æ‰€è¯´çš„å¤±å»äº† JavaScript åˆè¡·çš„ä¼˜é›…ã€‚æ‰€ä»¥ function å’Œ var å…³é”®å­—å¹¶ä¸ä¸€å®šè¢«å®£åˆ¤æ­»åˆ‘ï¼Œè€Œæ˜¯åœ¨ç‰¹å®šçš„æƒ…å†µä¸‹è¿˜èƒ½è¢«æ‹¿å‡ºæ¥ä½¿ç”¨ã€‚\n\nä¸è¿‡ï¼Œè¯è¯´å›æ¥ï¼Œä¼˜é›…çš„ä¸œè¥¿ä¸ä¸€å®šå°±æ˜¯æ‰€æœ‰äººå–œæ¬¢çš„ã€‚å—çº§ä½œç”¨åŸŸå¯¹ C è¯­è¨€ä½¿ç”¨è€…æ¥è¯´æ²¡æœ‰å­¦ä¹ éšœç¢ï¼Œå·¥ç¨‹ä¸Šè¿˜æ˜¯å°‘æ•°æœä»å¤šæ•°ï¼Œé€‰æ‹©æœ€ç®€å•çš„è€Œä¸æ˜¯é€‰æ‹©æœ€å¯¹ä¹Ÿå­˜åœ¨åˆç†æ€§ï¼Œæ‰€ä»¥å³ä½¿ç°åœ¨é¢å‘å¯¹è±¡é€æ¸å¤±å® ä¹Ÿä¸ä¸€å®šå°†æ¥ä¹Ÿä¼šè¢«æ‘’å¼ƒã€‚\n\nå¦å¤–ï¼ŒEich å’Œ Crockford è¿˜æœ‰ä¸€ç¯‡è®¿è°ˆï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ã€‚\n\n[Eich and Crockford on the Future of JavaScript: Insight from the Creators of JavaScript and JSON](https://www.infoq.com/news/2018/07/eich-crockford-js-future/)\n","collection":"blog","data":{"type":"post","category":"fe","tag":["JavaScript"]}},{"id":"2020/02/25/stryker-mutation test.md","slug":"2020/02/25/stryker-mutation-test","body":"\n# ä½¿ç”¨ stryker åš mutation test\n\nä»Šå¹´å¹´åˆçš„æ—¶å€™ï¼Œæˆ‘æ•´ç†äº†ä¸€ä¸‹å‰ç«¯æµ‹è¯•ç°çŠ¶ï¼Œæœ‰ä¸€é¡¹å°±æ˜¯ mutation testã€‚æœ¬æ–‡å°†ä¼šè®²ä¸€ä¸‹å¦‚ä½•ç»™ typescript é¡¹ç›®æ·»åŠ  mutation testã€‚\n\n## Stryker-mutator\n\né¦–å…ˆï¼Œä¸ºé¡¹ç›®å®‰è£… stryker å…¨å®¶æ¡¶ã€‚\n\n```shell\nyarn add -D stryker-typescript stryker-jest-runner stryker-html-reporter stryker-api stryker\n```\n\nä½ å¯èƒ½ä¼šæ¥åˆ°å‡çº§çš„è­¦å‘Šï¼Œæˆ‘å‘ç°æœ€æ–°ç‰ˆæœ¬ï¼ˆä»¥@stryker-mutator åšåŸŸï¼‰ä¼šæœ‰ bugï¼Œè€Œä¸” github ä¸Šé¢æ˜¾ç¤º CI ç¼–è¯‘å¤±è´¥ï¼Œä¿å®ˆèµ·è§ï¼Œè¿˜æ˜¯ä½¿ç”¨è€ç‰ˆæœ¬æ¯”è¾ƒå¥½ã€‚\n\næ‰§è¡Œ`yarn stryker init`åˆå§‹åŒ–é¡¹ç›®ï¼Œä¿®æ”¹ stryker.conf.jsï¼Œè¯¦ç»†çš„å‚æ•°è¯´æ˜å¯ä»¥å‚è€ƒ[è¿™é‡Œ](https://github.com/stryker-mutator/stryker/tree/master/packages/core)ã€‚\n\n```javascript\nmodule.exports = function stryker(config) {\n  config.set({\n    mutator: \"typescript\",\n    mutate: [\"src/linked_node/**/*.ts\", \"!src/**/*.spec.ts\"],\n    packageManager: \"yarn\",\n    reporters: [\"clear-text\", \"dashboard\", \"progress\", \"html\"],\n    testRunner: \"jest\",\n    coverageAnalysis: \"off\",\n    tsconfigFile: \"tsconfig.json\",\n    dashboard: {\n      reportType: \"full\",\n    },\n  });\n};\n```\n\næ³¨æ„ï¼Œå®˜ç½‘çš„ tutorial ä¼šè¦æ±‚æ·»åŠ  transpilor ä¸º typescriptï¼Œè¿™é‡Œå› ä¸ºæˆ‘ä»¬çš„æµ‹è¯• runner æ˜¯å·²ç»é…ç½®å¥½çš„ jestï¼Œæ‰€ä»¥ä¸èƒ½å†æ·»åŠ ä¸€æ¬¡ç¼–è¯‘ã€‚\n\næ‰§è¡Œ`yarn stryker run`å°±èƒ½æ‰§è¡Œæµ‹è¯•ï¼Œè¿™ä¸ªæµ‹è¯•å¾ˆå ç”¨æ€§èƒ½ï¼Œæˆ‘è¿™ 10 ä»£ i7 çš„æœ¬éƒ½è¦è·‘ 8 åˆ†é’Ÿå·¦å³ï¼Œæ‰§è¡ŒæˆåŠŸä¼šç”ŸæˆæŠ¥å‘Šå­˜å‚¨åœ¨ reports æ–‡ä»¶å¤¹ä¸‹ã€‚\n\n## é…ç½® travis\n\nstryker å®˜æ–¹æä¾›[dashboard](https://dashboard.stryker-mutator.io)ï¼Œç™»å…¥é…ç½®å¥½ç¯å¢ƒå˜é‡å³å¯ç”Ÿæˆ stryker çš„å¾½ç« ï¼Œå¯ä»¥æŠŠå®ƒè´´åˆ° github çš„ readme ä¸­ã€‚è¿™æ ·ï¼Œæ¯æ¬¡ travis æ‰§è¡Œå¥½ mutation test åéƒ½èƒ½æ›´æ–°å¾½ç« åˆ†æ•°ã€‚\n\nå…³äº dashboard å¦‚ä½•é…ç½®å¯ä»¥å‚è€ƒ[handbook](https://github.com/stryker-mutator/stryker-handbook/blob/master/dashboard.md)ã€‚\n\nä½†æ˜¯æˆ‘æ²¡èƒ½æˆåŠŸä¸Šä¼  reportï¼Œåªèƒ½æ˜¾ç¤ºå‡ºåˆ†æ•°ï¼Œå¹¶ä¸ç¡®å®šå“ªé‡Œå‡ºäº†é—®é¢˜ï¼Œè¿˜æ˜¯çœ‹å®˜æ–¹å¦‚ä½•æ›´æ–°å§ã€‚\n\n## åŸç†\n\nå¦‚æœæˆ‘æœ‰ä»¥ä¸‹å‡½æ•°ï¼Œå¹¶é…åˆ 100%æµ‹è¯•è¦†ç›–çš„å•å…ƒæµ‹è¯•ã€‚\n\n```typescript\nfunction isGe18(num: number) {\n  return num >= 18;\n}\n\ndescribe(\"the input is 1\", () => {\n  it(\"should return false\", () => {\n    expect(isGe18(1)).toBe(false);\n  });\n});\n```\n\næ˜¾ç„¶ä»¥ä¸Šçš„æµ‹è¯•æ˜¯ä¸å®Œå¤‡çš„ï¼Œé‚£ä¹ˆ stryker å¦‚ä½•æ‰¾åˆ°å®ƒä¸å®Œå¤‡çš„åœ°æ–¹ï¼Ÿé¦–å…ˆä¿®æ”¹å‡½æ•°çš„è¿”å›å€¼ï¼Œå¦‚ç”Ÿæˆå¦‚ä¸‹å››ä¸ªå‡½æ•°ã€‚\n\n```typescript\nfunction isGe18_1(num: number) {\n  return num > 18;\n}\nfunction isGe18_2(num: number) {\n  return num < 18;\n}\nfunction isGe18_3(num: number) {\n  return true;\n}\nfunction isGe18_3(num: number) {\n  return false;\n}\n```\n\nåˆ†åˆ«ç”¨ä»–ä»¬é‡æ–°è·‘æµ‹è¯•ï¼Œåªè¦æœ‰ä¸€ä¸ªæµ‹è¯•å¤±è´¥ï¼Œå°±ç§°è¿™ä¸ª mutate è¢« killedï¼Œå¦‚æœæµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼Œåˆ™ç§° mutate è¢« survivedã€‚\nåˆ™å¯¹åº”ä¸Šé¢ä¾‹å­ï¼š\n\n- isGe18_1 => survived\n- isGe18_2 => killed\n- isGe18_3 => killed\n- isGe18_3 => survived\n\nåˆ™æ­¤æ—¶éœ€è¦å¢åŠ æµ‹è¯•\n\n```typescript\ndescribe(\"the input is 19\", () => {\n  it(\"should return true\", () => {\n    expect(isGe18(19)).toBe(true);\n  });\n});\n\ndescribe(\"the input is 18\", () => {\n  it(\"should return true\", () => {\n    expect(isGe18(18)).toBe(true);\n  });\n});\n```\n\né‡æ–°è·‘æµ‹è¯•\n\n- isGe18_1 => killedï¼ˆæœ€åä¸€ä¸ªæµ‹è¯•æœªé€šè¿‡ï¼‰\n- isGe18_2 => killed\n- isGe18_3 => killed\n- isGe18_3 => killedï¼ˆæ–°å¢åŠ çš„ 2 ä¸ªæµ‹è¯•æœªé€šè¿‡ï¼‰\n\næ­¤æ—¶æµ‹è¯•æ‰æ˜¯å®Œå¤‡çš„ã€‚\n","collection":"blog","data":{"type":"post","category":"fe","tag":["test","stryker","javascript"]}},{"id":"2020/03/09/JS.md","slug":"2020/03/09/js","body":"\n# è¯»å®Œã€Œä½ ä¸çŸ¥é“çš„ JSã€ç¬¬ä¸€ç‰ˆ\n\n![book cover](./you-dont-know-about-JS.jpg)\n\nã€Œä½ ä¸çŸ¥é“çš„ JSã€æ˜¯[getify](https://github.com/getify)çš„ä¸€æœ¬å…³äºæ·±ç©¶ JavaScript çš„ä¹¦ï¼Œä¸­æ–‡ç‰ˆåˆ†ä¸ºä¸‰å†Œï¼Œå‰ä¸€é˜µå­å‘ç°ä½œè€…æ­£åœ¨æ›´æ–°ç¬¬äºŒç‰ˆï¼Œè¯»äº†å‡ é¡µçœŸçš„ä¸é”™ï¼Œäºæ˜¯æ‰¾æ¥ç¬¬ä¸€ç‰ˆè¯»äº†ä¸‹ã€‚\n\nç¬¬ä¸€ç‰ˆç¬¬ä¸€å†Œå°±æ˜¯æ·±ç©¶è¯æ³•ã€ä¸Šä¸‹æ–‡ï¼Œè¿™äº›ä¸œè¥¿å¤§éƒ¨åˆ†ä¹¦éƒ½æçš„æ¯”è¾ƒå°‘ï¼Œè¯´å®è¯ï¼Œè™½ç„¶æˆ‘å·²ç»äº†è§£äº†ï¼Œä½†æ˜¯æ€»æ˜¯å¿˜ã€‚è¿™æœ¬ä¹¦ç¬¬äºŒç‰ˆæ¯”ç¬¬ä¸€ç‰ˆå¥½å¤ªå¤šäº†ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»è¯»ä¸€ä¸‹ã€‚\n\nç¬¬äºŒå†Œï¼Œå¼‚æ­¥ï¼Œå…³äº promise å’Œç”Ÿæˆå™¨ï¼Œåº”è¯¥æ˜¯ç°æœ‰çš„å…³äºå¼‚æ­¥å†™çš„æœ€è¯¦ç»†çš„ä¹¦äº†ï¼Œä¸è¿‡æˆ‘æ›´æ„Ÿå…´è¶£ä»–èƒ½æ›´æ·±åº¦è®²è§£ä¸€ä¸‹ observableï¼Œè™½ç„¶è¿™ä¸ªè¿˜ä¸æ˜¯ JavaScript çš„æ ‡å‡†ã€‚\n\nç¬¬ä¸‰å†Œï¼ŒES6 ç›¸å…³ï¼Œå¾ˆæœ‰è¶£çš„æ˜¯ï¼ŒçœŸæœ¬ä¹¦å‰åŠéƒ¨åˆ†éƒ½æ˜¯å…³äºç¬¬ä¸€ç¬¬äºŒå†Œçš„ç®€è¿°ï¼Œæ‰€ä»¥å¦‚æœä½ åˆšå¥½ä¸Šä¸äº†ç½‘åªèƒ½ä¹°ä¹¦çš„è¯ï¼Œç›´æ¥çœ‹è¿™ä¸€æœ¬ä¹Ÿå·®ä¸å¤šã€‚\n\nåé¢æˆ‘å¯èƒ½ä¼šè¯»ä¸€ä¸‹ä¹¦ä¸­æ¨èçš„[Functiional Light JS](https://github.com/getify/Functional-Light-JS)ï¼Œä»¥åŠ 2ality å†™çš„[Deep JavaScript: Theory and techniques](https://exploringjs.com/deep-js/)ã€‚\n","collection":"blog","data":{"type":"post","category":"book","tag":["JavaScript"]}},{"id":"2020/03/21/Functional-Light-JS.md","slug":"2020/03/21/functional-light-js","body":"\næ¯”è¾ƒç®€å•çš„ä¸€æœ¬[å¼€æºä¹¦](https://github.com/getify/Functional-Light-JS)ï¼Œå¤§æ¦‚ç®—å‡½æ•°å¼ç¼–ç¨‹çš„å…¥é—¨ä¹¦+JavaScript éƒ¨åˆ†ä»‹ç»äº†ã€‚\n\næ¨èç« èŠ‚ï¼š\n\n- ç¬¬å››ç« ï¼Œä¸ºä»€ä¹ˆè¦å‡å°‘å‡½æ•°å‚æ•°ä»¥åŠæŸ¯é‡ŒåŒ–ï¼Œè¿™æ ·æœ‰åˆ©äºä½¿ç”¨ compose å‡½æ•°ç»„åˆæ­¥éª¤ã€‚\n- ç¬¬å…«ç« ï¼Œé€’å½’ï¼Œåˆ©ç”¨ es6 ä¸Šé¢çš„å°¾é€’å½’è°ƒç”¨æé«˜ä»£ç å¯è¯»æ€§ã€‚\n- é™„å½• Aï¼Œæé«˜æ€§èƒ½ï¼Œå‡å°‘è¿ç®—æŸè€—ã€‚\n","collection":"blog","data":{"type":"post","category":"book","tag":["JavaScript","functinal-programming"]}},{"id":"2020/03/27/svelte.md","slug":"2020/03/27/svelte","body":"\n# Svelte è®©äººçœ¼å‰ä¸€äº®çš„å‰ç«¯æ¡†æ¶\n\næˆ‘è§‰å¾—å¿…é¡»è¦ä»‹ç»ä¸€ä¸‹ [svelte](https://svelte.dev/) è¿™ä¸ªæ¡†æ¶ï¼Œç¡®åˆ‡çš„è¯´æ˜¯ svelte v3ï¼Œè¿™åº”è¯¥æ˜¯ç»§ [riotjs](http://riot.js.org/)ã€[typescript](https://www.typescriptlang.org/) å’Œ [rust](https://www.rust-lang.org/) ä¹‹ååˆä¸€ä¸ªèƒ½ç»™æˆ‘çœ¼å‰ä¸€äº®çš„æ„Ÿè§‰çš„äº§å“äº†ã€‚\n\n## å…³äº Svelte\n\nä¸å¾—ä¸æåˆ°ä»–çš„ä½œè€… [Rich Harris](https://github.com/Rich-Harris)ï¼Œæåˆ°ä»–çš„å¦ä¸€ä¸ªä½œå“å°±æ˜¯å¤§åé¼é¼çš„ [rollup](http://rollupjs.org/)ï¼Œè¿™å¯æ˜¯ç¬¬ä¸€ä¸ªæå‡º tree-shaking çš„å‰ç«¯æ‰“åŒ…å™¨ï¼ˆè¯´å®è¯ï¼Œè¿™å¯¼è‡´æˆ‘æœ‰æ›´å¤šçš„æ‹…å¿§ï¼Œsvelte å¯èƒ½ä¼šå˜æˆåƒ rollup ä¸€æ ·çš„å°ä¼—ç‹‚æ¬¢ï¼‰ã€‚\n\nå›åˆ° svelteï¼Œä»–ä» v1 çš„æ—¶å€™ç›®æ ‡å°±æ˜¯ç®€å•ï¼Œåªä¸è¿‡ v1 ç‰ˆæœ¬çœ‹èµ·æ¥å¤ªåƒ zepto äº†ï¼ˆé‚£æˆ‘ä¸ºä»€ä¹ˆä¸ç”¨åŸç”Ÿ JavaScriptï¼‰ã€‚ä¸è¿‡ v3 ç‰ˆæœ¬è¿™ä¸ªæ¡†æ¶æ¢äº†ä¸ªæ–¹å‘ï¼Œä»æ¡†æ¶å˜æˆäº†ç¼–è¯‘å™¨ï¼Œç±»ä¼¼äº riotjs å’Œ vuejsï¼Œç»„ä»¶çš„ htmlã€css å’Œ js å¯ä»¥å†™åœ¨ä¸€èµ·ï¼Œå…¶å®æˆ‘å¹¶ä¸æ˜¯ç‰¹åˆ«æ¨å´‡è¿™ç§åšæ³•ï¼Œå¾€å¾€æœ‰æ—¶å€™æˆ‘æ›´å€¾å‘äº angularJS çš„åšæ³•ï¼Œä½†æ˜¯ svelte çš„å¤„ç†çœŸçš„å¤ªå®Œç¾ã€‚\n\n```html\n<script>\n  const hello = \"world\";\n</script>\n\n<h1>{hello}</h1>\n\n<style>\n  h1 {\n    color: black;\n  }\n</style>\n```\n\nçœ‹åˆ°äº†å—ï¼Ÿæ²¡æœ‰å¤šå‡ºæ¥çš„ `Vue.extend()`ï¼ŒHTML å’Œ JavaScript éƒ¨åˆ†çš„äº¤äº’ç«Ÿç„¶è¿™å„¿ä¹ˆå®Œç¾ï¼è¦æ˜¯ CSS å†åŠ æŠŠåŠ›å°±æ›´å¥½äº†ï¼ˆä¸è¿‡å¦‚æœæ˜¯ CSS in JS çš„è¯...é‚£è¿˜æ˜¯ç”¨æŸä¸ª preprocessor å‹‰å¼ºä¸€ä¸‹å¥½äº†ï¼‰ã€‚HTML æ¨¡æ¿ç±»ä¼¼æ¯”è¾ƒç®€å•çš„ handlebars è¯­æ³•ï¼Œç”šè‡³æ”¯æŒå¼‚æ­¥æ¨¡æ¿ã€‚\n\nå¦å¤– svelte æ²¡æœ‰è™šæ‹Ÿ DOMï¼Œè¿™ä¸€ç‚¹æˆ‘æœ‰ä¸€äº›ç›¸è§æ¨æ™šï¼Œæˆ‘ä¹‹å‰å°±å†™è¿‡[æ–‡ç« ](/fe/2016/03/31/VUE&Riot&Reactå®åŠ›æ¯”è¾ƒ.html)è´¨ç–‘è™šæ‹Ÿ DOM æ˜¯ä¸æ˜¯çœŸçš„èƒ½å¸¦æ¥æ€§èƒ½æé«˜ï¼ˆç»“æœæ˜¯æ€§èƒ½å¾ˆå·®ï¼‰ï¼Œä½†æ˜¯æœ€ç»ˆè¢«äººå–·äº†ï¼Œå¯¼è‡´ä¸€å¹´åä¸å¾—ä¸[å¼ƒå‘ riotjs æ”¹ç”¨ preact](/fe/2017/05/15/å¼ƒå‘Riotè½¬å‘Preact.html)ã€‚ä½†æˆ‘å§‹ç»ˆè®¤ä¸ºè™šæ‹Ÿ DOM æ›´æ˜¯ä¸€ä¸ªèŒƒå¼è€Œä¸æ˜¯èƒ½å¸¦æ¥æ€§èƒ½æå‡çš„ç¥å™¨ã€‚æ‰€ä»¥ä½ ä»£ç å·®ï¼Œæ¢ä»€ä¹ˆèŒƒå¼ï¼Œæ€§èƒ½éƒ½å·®ï¼Œå–·åˆ«äººä¹‹å‰å…ˆç§°ç§°è‡ªå·±å‡ æ–¤å‡ ä¸¤å¥½ä¹ˆï¼Ÿ\n\nsvelte ç¬¦åˆå“åº”å¼æ¨¡å¼ï¼Œè¿™ä¸€ç‚¹å’Œ riotjs å¾ˆç±»ä¼¼ï¼Œå€ŸåŠ© svelte è¿™ä¸ªç¼–è¯‘å™¨ï¼Œå†™å¥½çš„ç»„ä»¶ä¼šè¢«ç¼–è¯‘æˆå“åº”å¼å‡½æ•°ã€‚ä¹Ÿè®¸æ‹¿ riotjs åšæ¯”æ–¹ä¼šæ¯”è¾ƒéš¾ï¼Œè¿™é‡Œæ‹¿ react åšæ¯”æ–¹ï¼Œåœ¨ react ä¸­å®ç°å“åº”å¼éœ€è¦ä½¿ç”¨`setState()`ã€‚\n\n```JavaScript\nconst Com = () => {\n    const [state, setState] = useState(1);\n    useEffect(() => setState(state + 1), [])\n    const stateX2 = state*2;\n\n    return (\n    <>\n        <div>{state*2}</div>\n        <div>{stateX2}</div>\n    </>\n    );\n}\n/* è¾“å‡º\n * <div>2</div>\n * <div>2</div>\n*/\n```\n\nè€Œç”±äº svelte æ˜¯ä¸ªç¼–è¯‘å™¨ï¼Œsvelte é‡Œé¢ä¸ä»…ä»£ç æ›´å°‘ï¼Œè€Œä¸”æ­£ç¡®çš„è¾“å‡ºäº†`stateX2`çš„å€¼ã€‚\n\n```HTML\n<script>\nimport { onMount } from \"svelte\";\n\nlet state = 1;\n\nonMount(() =>  state += 1);\n\n$: let stateX2 = state * 2;\n</script>\n\n<div>{state}</div>\n<div>{stateX2}</div>\n\n<!--\n    è¾“å‡º\n    <div>2</div>\n    <div>4</div>\n-->\n```\n\næ²¡é”™ï¼Œå®Œå…¨æ²¡æœ‰å¤šä½™çš„ä»£ç ï¼ˆå…¶å® svelte ç¼–è¯‘å™¨ä¼šé»˜é»˜åœ°ç»™`state`å¢åŠ ä¸€ä¸ª`observable`çš„é…ç½®ï¼Œä½†æ˜¯è¿™éƒ½æ˜¯ç¼–è¯‘å™¨è‡ªå·±åšçš„ï¼Œå¼€å‘è€…å®Œå…¨ä¸éœ€è¦è€ƒè™‘ï¼‰ã€‚è¿™é‡Œå‘ç°`stateX2`å‰é¢æœ‰ä¸€ä¸ª`$`æ ‡è¯†ï¼Œè¡¨æ˜åé¢çš„è¯­å¥æ˜¯å“åº”å¼çš„ã€‚è¿™ä¸€ç‚¹çœŸçš„å¾ˆå·§å¦™ï¼Œå› ä¸ºè¿™ä¸ªè¯­æ³•æ˜¯ JavaScript æ ‡å‡†é‡Œç™¾å¹´ä¸é‡çš„`goto`è¯­å¥ï¼Œsvelte é«˜æ˜çš„ä½¿ç”¨ JavaScript åŸæœ‰çš„è¯­æ³•å®ç°äº†æ–°çš„åŠŸèƒ½ï¼Œä¸åƒæŸæ¡†æ¶æ„£æ˜¯åŠ äº†ä¸€ä¸ª JSX è¯­æ³•ï¼ˆä¸æ˜¯é„™è§† JSXï¼ŒJSX ä¹Ÿå¾ˆç‰›é€¼çš„è¯´ï¼‰ã€‚\n\nåœ¨ n å¤šä¸ªæ¡†æ¶éƒ½åœ¨æ¨¡ä»¿ react çš„ä¸»æµä¸‹ï¼Œè¿™ä¸ªæ¡†æ¶è¿˜èƒ½åˆ«å‡ºå¿ƒè£ï¼Œä¸å¾—ä¸èµï¼Œå¦‚æœä½ æ„Ÿå…´è¶£ï¼Œæˆ‘å¼ºçƒˆæ¨èæµè§ˆä»–ä»¬çš„[ä¾‹å­](https://svelte.dev/examples#hello-world)ã€‚store å’Œ context éƒ½éå¸¸æœ‰å¯å‘ã€‚\n\næœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯ç›®å‰è¿˜æ²¡æœ‰å®˜æ–¹çš„ TypeScript æ”¯æŒï¼Œè¿™ä¸€ç‚¹å¾ˆæœ‰å°´å°¬ï¼Œå› ä¸º svelte æœ¬èº«å°±æ˜¯ TypeScript å†™çš„ã€‚ä¸è¿‡ç°åœ¨æœ‰ç¬¬ä¸‰æ–¹çš„[svelte-preprocess](https://github.com/kaisermann/svelte-preprocess)å¯¹ TypeScript æä¾›æ”¯æŒï¼Œä¸çŸ¥é“å•¥æ—¶å€™è½¬æ­£ã€‚\n\n## Sapper\n\nriotjs åŒæ ·æ²¡æœ‰è™šæ‹Ÿ DOMï¼Œè¿™ä½¿å¾—å®ƒåœ¨ SSR æ–¹é¢ä¼š[æœ‰ä¸€äº›é—®é¢˜](https://riot.js.org/documentation/#riot-dom-caveats)ï¼Œä½†æ˜¯ Svelte æä¾›äº†ä¸€å¥— SSR è§£å†³æ–¹æ¡ˆï¼Œ[sapper](https://sapper.svelte.dev/) åŒæ—¶æ”¯æŒ node æ¸²æŸ“å’Œé™æ€å‘å¸ƒã€‚\n\nSapper å— next.js å¯å‘ï¼Œä½¿ç”¨`src/route`æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶åšè·¯ç”±ã€‚\n\n```\nsrc/routes\n    _layout.svelte -- å¸ƒå±€æ–‡ä»¶\n    _error.svelte  -- 404ç›®å½•\n    index.svelte   -- /æˆ–è€…/index\n    posts.json.js  -- /post.jsonï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼expressè·¯ç”±çš„æ–¹å¼å†™æ¥å£\n```\n\næƒ³è¦åœ¨ index é‡Œé¢å®ç° server ç«¯çš„é¢„åŠ è½½ï¼Œå¯ä»¥ä½¿ç”¨ sapper çš„ preload APIã€‚\n\n```html\n<script context=\"module\">\n  export async function preload(page, session) {\n    const res = await this.fetch(\"posts.json\");\n    const { posts } = await res.json();\n\n    return { posts };\n  }\n</script>\n```\n\nè¿™æ ·ä¼šåœ¨`window`ä¸Šé¢æ³¨å…¥ä¸€ä¸ª`__SAPPER__`å˜é‡æŠŠ server ç«¯é¢„åŠ è½½çš„å€¼èµ‹ä¸Šå»ã€‚\n\nå› ä¸º sapper è¿˜åœ¨ beta é˜¶æ®µï¼Œæˆ‘ä¹Ÿä¸æ•¢æ‹¿æ¥å¼€å‘ä»€ä¹ˆå¤§é¡¹ç›®ï¼Œä½†çœŸå¿ƒæƒ³å†™å†™ svelteï¼Œå› ä¸ºå®ƒåœ¨å¾ˆå¤šåœ°æ–¹éå¸¸æœ‰æ–°æ„ï¼Œå†å²åŒ…è¢±ä¹Ÿä¸å¤§ï¼Œæš‚æ—¶å†™ä¸ª [CSS playground](https://css.gongbushang.com/) æ¥åš [CSS Secrets](http://shop.oreilly.com/product/0636920031123.do) çš„ç¬”è®°å¥½äº†ã€‚\n\n## å•å…ƒæµ‹è¯•\n\n[testing-library](https://testing-library.com/docs/svelte-testing-library/intro) æä¾›å•å…ƒæµ‹è¯•æ”¯æŒï¼Œé…ç½®èµ·æ¥ç»å¯¹æ¯” react å’Œ vue ç®€å•ï¼Œåªæ˜¯å› ä¸ºæ¯”è¾ƒæ–°ï¼Œæ‰€ä»¥æ²¡æœ‰ç±»ä¼¼çš„ create react app è¿™ç§å®˜æ–¹è„šæ‰‹æ¶ï¼Œå½“ç„¶å¦‚æœ sapper å‡ºæ­£å¼ç‰ˆäº†å°±ç®—æœ‰äº†ã€‚\n","collection":"blog","data":{"type":"post","category":"fe","tag":["svelte","sapper","JavaScript","rollup"]}},{"id":"2020/04/04/ObservableHQ-JS-Jupyter.md","slug":"2020/04/04/observablehq-js-jupyter","body":"\n# ObservableHQ-JS ç»ˆäºæœ‰è‡ªå·±çš„ Jupyter ç¬”è®°æœ¬äº†\n\nå­¦ä¹ æœºå™¨å­¦ä¹ çš„æ—¶å€™ç”¨ä¸Š python çš„ Jupyter notebook æ˜¯çœŸå¥½ç”¨ï¼Œæ›¾ç»å°±æƒ³ï¼Œå¦‚æœ JavaScript ä¹Ÿæœ‰ä¸€ä¸ªå°±å¥½äº†ï¼Œæ²¡é”™[ObservableHQ](https://observablehq.com/)å°±æ˜¯åŸºäº D3.js çš„æ•°æ®å¯è§†åŒ–ç¬”è®°æœ¬ã€‚\n\nå®˜æ–¹çš„[å…¥é—¨](https://observablehq.com/@observablehq/a-taste-of-observable)è®²çš„å¾ˆè¯¦ç»†ï¼Œæ¥ä¸‹æ¥ä¸€å‘¨æˆ‘å¯èƒ½ä¼šä¸“å¿ƒäºé‡Œé¢çš„[D3 æ•™ç¨‹](https://observablehq.com/@d3/learn-d3)ï¼Œé—´æˆ–å»å­¦ä¹  threejs fundamentalã€‚\n","collection":"blog","data":{"type":"post","category":"fe","tag":["observablehq","JavaScript","d3","jupyter"]}},{"id":"2020/04/13/threejs-fundamentals-threejs.md","slug":"2020/04/13/threejs-fundamentals-threejs","body":"\n# threejs fundamentals åå‰¯å…¶å®çš„ threejs å…¥é—¨ä¹¦\n\næœ€è¿‘å‡ å¤©çœŸæ˜¯å¿™ï¼Œé™¤äº†è¯»è¿™æœ¬ä¹¦ï¼Œæˆ‘çš„å¹³æ¿ï¼ˆé…·æ¯”é­”æ–¹ Mix Plusï¼‰çªç„¶è¿›ä¸å»ç³»ç»Ÿäº†ï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼ŒåŸæ¥å±±å¯¨æœ¬ç¡¬ç›˜è´¨é‡ä¸å¥½ï¼Œè«åå…¶å¦™å…¨æ¸…äº†ï¼ˆæƒŠï¼ï¼‰ï¼Œå¥½åœ¨åšäº†å¤‡ä»½ï¼Œå½“ç„¶å› ä¸ºä¸æƒ³èŠ±é’±ï¼Œæ²¡å†ä¹°ä¸€ä¸ª SATA SSD ç¡¬ç›˜ï¼ŒèŠ±äº†ä¸€äº›æ—¶é—´é‡åšç³»ç»Ÿã€‚\n\nç¥¸ä¸å•è¡Œï¼Œä¸»åŠ›æœº Dell inspiron 13 é£æ‰‡åäº†ï¼Œè™½ç„¶å·²ç»æŠ¥ä¿®ï¼Œä½†è¿˜åœ¨èµ°æµç¨‹ï¼Œè¿™ä½¿å¾—æˆ‘ç°åœ¨åªèƒ½ä»¥ 1.8GHzï¼ˆå…³é—­é£æ‰‡ï¼‰ å·¥ä½œ ğŸ˜­ã€‚\n\næ­£å¥½ï¼Œåˆšåšå®Œç³»ç»Ÿï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« æˆ‘äº‰å–åœ¨å¹³æ¿ä¸Šå†™ï¼Œä»¥ä¿è¯ç³»ç»Ÿå®‰è£…æ­£ç¡®ã€‚\n\nå¦å¤–ï¼Œå› ä¸ºæŠ¢åˆ°äº†ç¦ç”°çš„æ¶ˆè´¹åˆ¸ï¼Œæ‰€ä»¥è¿™æœ¬ä¹¦çš„å®ç°ï¼Œäº‰å–åœ¨æœ¬å‘¨å®Œæˆã€‚\n","collection":"blog","data":{"type":"post","category":"book","tag":["threejs","JavaScript","webGL"]}},{"id":"2020/04/21/threejs-mesh.md","slug":"2020/04/21/threejs-mesh","body":"\n# threejs ç»†åŒ–-åˆ›å»ºä¸€ä¸ª meshã€ä½¿ç”¨åŠ è½½å™¨ã€å¤šä¸ªåœºæ™¯\n\nè®°å½•ä¸‹æœ€è¿‘å‡ å¤©çš„äº‹ï¼Œç»ˆäº Dell çš„ç»´ä¿®æŠŠæˆ‘ç”µè„‘çš„é£æ‰‡ä¿®å¥½äº†ï¼Œä¸è¿‡æ„Ÿè§‰ inspiron çš„é£æ‰‡è®¾è®¡æœ‰ bugï¼Œæ–°é£æ‰‡ä¼°è®¡ä¹Ÿæ’‘ä¸äº†å¤šä¹…ï¼Œä½†æ„¿åªæ˜¯æˆ‘å¤šç–‘äº†ã€‚å¦å¤–é€šè¿‡ç¥å¥‡çš„æŸå®ï¼Œæˆ‘å°†æˆ‘æ‰‹ä¸Šçš„å°ç±³å¹³æ¿äºŒå‡çº§äº†å†…å­˜å’Œç¡¬ç›˜ï¼Œè€ƒè™‘åˆ° 8GB å†…å­˜å¯¹äº Atom Z8500 è¿™ä¸ª CPU æœ‰ç‚¹å¤šä½™ï¼Œäºæ˜¯å‡çº§åˆ°äº† 4GB + 128GBï¼Œåˆ°æ‰‹ä¹‹åæœç„¶æ¯” 2GB æµç•…ï¼ˆå½“ç„¶è‚¯å®šæ²¡æ³•æ¯”é…·ç¿äº†ï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªé…ç½®è¿˜æ˜¯æ¯”è¾ƒæ¨èçš„ã€‚\n\nå›åˆ°ä¸»é¢˜ï¼Œæœ€è¿‘ä¸€å‘¨æˆ‘éƒ½åœ¨ä½¿ç”¨ react-three-fiber æ¥å­¦ä¹  threejsï¼Œè¿™é‡Œä¼šåšä¸€ä¸ªç³»åˆ—æ¥è¯¦ç»†æ•´ç†ä¸€ä¸‹ã€‚\n\n## åˆ›å»ºä¸€ä¸ª mesh\n\nå¯ä»¥ä½¿ç”¨ JSX åˆ›å»º mesh, å› ä¸º mesh æœ‰ material å’Œ geometry ä¸¤ä¸ªè®¿é—®å™¨ï¼Œåœ¨ JSX ä¸­å¯ä»¥ä½œä¸ºå±æ€§ä½¿ç”¨ã€‚\n\n```JavaScript\nexport default () => (\n    <Canvas>\n        <mesh\n            name=\"mesh\"\n            material={new MeshBasicMaterial()}\n            geometry={new BoxBufferGeometry(1, 1, 1)}\n        />\n    </Canvas>\n);\n```\n\nå½“ç„¶ä½œä¸ºå‚æ•°ä¹Ÿå¯ä»¥ã€‚\n\n```JavaScript\nexport default () => (\n    <Canvas>\n        <mesh arg={[new BoxBufferGeometry(1, 1, 1), new MeshBasicMaterial()]}/>\n    </Canvas>\n);\n```\n\nå®˜ç½‘è¿˜æä¾›äº†ä¸€ä¸ªç»å¦™çš„æ–¹æ³•ã€‚\n\n```JavaScript\n// å®ç°ä¸äº†ï¼Œä¸çŸ¥é“å’‹å›äº‹å„¿\nexport default () => (\n    <Canvas>\n        <mesh>\n            <boxBufferGeometry attach=\"geometry\" />\n            <meshBasicMaterial attach=\"material\" />\n        </mesh>\n    </Canvas>\n);\n```\n\nå¦å¤–å› ä¸º Canvas é‡Œé¢çš„å…ƒç´ å’Œ JSX çš„ç»‘å®šä½¿ç”¨çš„æ˜¯ memoï¼Œæ‰€ä»¥å¦‚æœä½¿ç”¨ primitive å®šä¹‰å…ƒç´ çš„æ—¶å€™ä¼šä¸¢ã€‚\n\n```JavaScript\n// è¿™ä¹ˆåšè™½ç„¶ä¼šæ¸²æŸ“å‡ºæ¥ï¼Œä½†æ˜¯Boxæœ‰çš„æ—¶å€™ä¼šä¸¢\nconst Box = new Mesh(\n    new BoxBufferGeometry(1, 1, 1),\n    new MeshBasicMaterial(),\n);\n\nexport default () => (\n    <Canvas>\n        <primitive object={Box} />\n    </Canvas>\n);\n```\n\n## åŠ è½½å™¨\n\nåŠ è½½ texture æ—¶ï¼Œå¯ä»¥ä½¿ç”¨`useEffect`è‡ªå·±å†™ï¼Œå½“ç„¶ä¹Ÿæœ‰æ›´ä¼˜é›…çš„æ–¹æ³•ï¼Œåˆ©ç”¨ react è‡ªå·±çš„`useMemo`æˆ–è€…`useCallback`ï¼Œå†å°±æ˜¯ä½¿ç”¨ react three fiber çš„`useLoader`ã€‚\n\n```JavaScript\n// ä½¿ç”¨ useMemo\nconst Plane = () => {\n    const texture = useMemo(() => new TextureLoader().load(\"xxx.jpg\"), [])\n    return <mesh\n        material={new MeshBasicMaterial({map: texture})}\n        geometry={new PlaneGeometry(1, 1)}\n    />\n}\n```\n\n```JavaScript\n// ä½¿ç”¨ useLoader\nconst PlaneAsync = () => {\n    const [texture] = useLoader(TextureLoader, \"xxx.jpg\");\n\n    return <mesh\n        material={new MeshBasicMaterial({map: texture})}\n        geometry={new PlaneGeometry(1, 1)}\n    />\n}\n\nconst Plane = () => (\n        <Suspense fallback={<mesh />}>\n            <PlaneAsync />\n        </Suspense>\n    )\n```\n\n## ä½¿ç”¨å¤šä¸ªåœºæ™¯\n\nthree react fiber ä¼šé»˜è®¤ç»™ä¸€ä¸ªåœºæ™¯(scene)ã€ä¸€ä¸ªæ‘„åƒå¤´(camera)è¿˜æœ‰ä¸€ä¸ªæ¸²æŸ“å™¨(render)ã€‚å¯æ˜¯å¦‚æœæˆ‘éœ€è¦å¤šä¸ªåœºæ™¯ï¼Œæ¯”å¦‚å»ºæ¨¡å·¥å…·å¾€å¾€ä¼šç»™ä¸€ä¸ªæ­£äº¤è§†å›¾ä»¥åŠæ­£è§†å›¾ï¼Œè¿™ç§æƒ…å†µå°±éœ€è¦å¤šä¸ªåœºæ™¯ã€‚\n\né¦–å…ˆè¦ä½¿ç”¨`setDefaultCamera`å°†æ–°å»ºçš„æ‘„åƒå¤´ä»£æ›¿é»˜è®¤æ‘„åƒå¤´ã€‚\n\n```TypeScript\nexport default () => {\n    const { setDefaultCamera } = useThree();\n    const camera = useRef<PerspectiveCamera>();\n\n    useLayoutEffect(() => camera.current && setDefaultCamera(camera.current), [])\n\n    return <perspectiveCamera\n      name=\"camera\"\n      ref={camera}\n    />\n}\n```\n\næ¥ä¸‹æ¥æ˜¯åˆ›å»ºåœºæ™¯ï¼Œåœºæ™¯ä¸éœ€è¦ä»£æ›¿åŸæœ‰åœºæ™¯ï¼Œä½†æ˜¯éœ€è¦ä½¿ç”¨`useFrame`ä¿®æ”¹`render`æ–¹æ³•ã€‚\n\n```TypeScript\n// å†åŸç”»é¢çš„å·¦ä¸Šè§’ç»˜åˆ¶åœºæ™¯\nexport default () => {\n    const scene = useRef<Scene>();\n    const {\n        size: {left, top, width, height},\n        camera,\n    } = useThree();\n\n    useFrame(({ gl }) => {\n        gl.autoClear = true;\n        gl.setScissor(left, top, width / 2, height / 2);\n        gl.setViewport(left, top, width / 2, height / 2);\n\n        scene.current && gl.render(scene, camera)\n    }, 10);\n\n    return (\n        <scene ref={scene}>\n            <mesh />\n        </scene>\n    );\n}\n```\n\nè¿™é‡Œ`useFrame`çš„ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºå®ƒçš„ä¼˜å…ˆçº§ï¼Œå€¼è¶Šé«˜ï¼Œè¶Šå…ˆæ¸²æŸ“ï¼Œè¿™æ„å‘³ç€æ¯”å®ƒä¼˜å…ˆçº§ä½çš„åœºæ™¯æ¸²æŸ“ä¹‹å‰è¦æŠŠ`gl.autoClear`è®¾ç½®ä¸º`false`ï¼Œä»¥é¿å…è¢«æ¸…é™¤ã€‚\n\n## å…¶å®ƒ\n\nå¦å¤–å¯ä»¥çœ‹çœ‹äº¬ä¸œçš„ä¸€ç¯‡åšå®¢[å‡¹å‡¸å®éªŒå®¤](https://aotu.io/notes/2018/10/18/cannonjs/index.html)ã€‚\n","collection":"blog","data":{"type":"post","category":"fe","tag":["threejs","JavaScript","webGL"],"series":{"slug":"threejs-howto","name":"ç»†å“threejs"}}}]}